---
- name: Get Ubuntu LTS release
  ansible.builtin.command: ubuntu-distro-info --lts
  register: ubuntu_lts_release
  run_once: true
  changed_when: false

- name: Set ubuntu_lts_release fact
  ansible.builtin.set_fact:
    ubuntu_lts_release: "{{ ubuntu_lts_release.stdout }}"

- name: Add Seafile repository
  ansible.builtin.deb822_repository:
    name: seafile
    types: deb
    uris: https://linux-clients.seafile.com/seafile-deb/{{ ubuntu_lts_release }}/
    suites: stable
    components: main
    architectures: amd64
    signed_by: https://linux-clients.seafile.com/seafile.asc

- name: Install libwebsockets16 from Ubuntu Jammy archive
  ansible.builtin.apt:
    deb: http://archive.ubuntu.com/ubuntu/pool/universe/libw/libwebsockets/libwebsockets16_4.0.20-2ubuntu1_amd64.deb

- name: Install Seafile Client
  ansible.builtin.apt:
    name: seafile-gui
    update_cache: true
    state: latest
...
